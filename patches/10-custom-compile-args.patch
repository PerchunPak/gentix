diff --git a/lib/systems/platforms.nix b/lib/systems/platforms.nix
index d2e8f77bec03..04c642ab3064 100644
--- a/lib/systems/platforms.nix
+++ b/lib/systems/platforms.nix
@@ -16,6 +16,8 @@ rec {
       autoModules = true;
       target = "bzImage";
     };
+
+    gcc.args = "-march=znver3 -O2 -pipe -fomit-frame-pointer -fno-semantic-interposition";
   };
 
   pc_simplekernel = lib.recursiveUpdate pc {
diff --git a/pkgs/build-support/cc-wrapper/default.nix b/pkgs/build-support/cc-wrapper/default.nix
index 4adc1dcb1f8d..cff6552467ec 100644
--- a/pkgs/build-support/cc-wrapper/default.nix
+++ b/pkgs/build-support/cc-wrapper/default.nix
@@ -612,8 +612,9 @@ stdenvNoCC.mkDerivation {
 
     # Machine flags. These are necessary to support
 
-    # TODO: We should make a way to support miscellaneous machine
-    # flags and other gcc flags as well.
+    + (optionalString (targetPlatform ? gcc.args) ''
+      echo "-march=${targetPlatform.gcc.args}" >> $out/nix-support/cc-cflags-before
+    '')
 
     # Always add -march based on cpu in triple. Sometimes there is a
     # discrepency (x86_64 vs. x86-64), so we provide an "arch" arg in
